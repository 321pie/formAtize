<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="Document.css">
    <title>Document</title>
</head>
<body>
    <div id="home_menu">
        <ul>
            <li><button onclick="handleHomePageClick()">Back</button></li>
            <li id="document_name">Document</li>
            <li><button onclick="handleSaveDocumentClick()">Save</button></li>
        </ul>
    </div>

    <div id="pages">
        <textarea id="block1"></textarea>
    </div>

    <div id="block_menu">
        <ul>
            <li><button>Block</button></li>
            <li><button>Edit</button></li>
            <li><button>Display</button></li>
        </ul>
    </div>

    <script>
        //Retrieve data from local storage and reet for future documents
        const FILE_ID = localStorage.getItem("fileId");
        document.getElementById('document_name').innerText = localStorage.getItem("fileName");
        localStorage.clear();

        //Load document text
        let request = gapi.client.drive.files.get({
          'fileId': fileId
        });

        const res = await gapi.client.drive.files.get({
          'fileId': fileId,
          'alt': 'media',
        }, {
          'responseType': 'arraybuffer',
        });

        document.getElementById("document_body").value = JSON.parse(JSON.stringify(res, null, 4)).body;


        /**
       * Create a document
       
      function handleCreateClick() {
        // Get the popup window element
        let fileId = 0;

        // Hide the popup window when the create button is clicked
        document.getElementById("popup_window").style.visibility = "hidden";

        //Create document with data from popup window
        var fileContent = `${document.getElementById("document_text").value}`; // As a sample, upload a text file.
        var file = new Blob([fileContent], {type: 'text/plain'});
        var metadata = {
            'name': `${document.getElementById("document_title").value}`, // Filename at Google Drive
            'mimeType': 'text/plain', // mimeType at Google Drive
            'parents': [FOLDER_ID], // Folder ID at Google Drive
        };

        var accessToken = gapi.auth.getToken().access_token; // Here gapi is used for retrieving the access token.
        var form = new FormData();
        form.append('metadata', new Blob([JSON.stringify(metadata)], {type: 'application/json'}));
        form.append('file', file);

        var xhr = new XMLHttpRequest();
        xhr.open('post', 'https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id');
        xhr.setRequestHeader('Authorization', 'Bearer ' + accessToken);
        xhr.responseType = 'json';
        xhr.onload = () => {
            console.log(xhr.response.id); // Retrieve uploaded file ID.
        };
        xhr.send(form);

        //TODO: change?
        //Show document retrieval text area
        document.getElementById("document_load").style.visibility = "visible";

        listFiles();
      }*/
    </script>
</body>
</html>
